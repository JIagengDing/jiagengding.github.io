<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><title>Services Used in Nas - Jiageng's Blog</title>
<meta name=renderer content="webkit"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=Cache-Control content="no-transform"><meta http-equiv=Cache-Control content="no-siteapp"><meta name=theme-color content="#f8f5ec"><meta name=msapplication-navbutton-color content="#f8f5ec"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec"><meta name=baidu-site-verification content="codeva-GQ1brmFXeW"><meta name=author content="Jiageng Ding"><meta name=description content="I installed the PVE system on the base layer of my NAS for virtualization, primarily using OpenWRT and Debian virtual machines. OpenWRT is used for dialing and routing, allocated two CPUs and 1GB of memory, with a passthrough network port for WAN connection to the optical modem. The Debian system is responsible for running most of the services I use daily, including providing DNS, RSS, and media services.
"><meta name=keywords content="share knowledge,record life"><meta name=generator content="Hugo 0.127.0 with theme even"><link rel=canonical href=https://blog.diing.uk/en/post/services-used-in-nas/><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/manifest.json><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><script defer src=https://cn.vercount.one/js></script><link href=/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin=anonymous><meta property="og:url" content="https://blog.diing.uk/en/post/services-used-in-nas/"><meta property="og:site_name" content="Jiageng's Blog"><meta property="og:title" content="Services Used in Nas"><meta property="og:description" content="I installed the PVE system on the base layer of my NAS for virtualization, primarily using OpenWRT and Debian virtual machines. OpenWRT is used for dialing and routing, allocated two CPUs and 1GB of memory, with a passthrough network port for WAN connection to the optical modem. The Debian system is responsible for running most of the services I use daily, including providing DNS, RSS, and media services."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2024-06-23T11:46:39+08:00"><meta property="article:modified_time" content="2024-06-23T11:46:39+08:00"><meta property="article:tag" content="Nas"><meta property="article:tag" content="Docker"><meta itemprop=name content="Services Used in Nas"><meta itemprop=description content="I installed the PVE system on the base layer of my NAS for virtualization, primarily using OpenWRT and Debian virtual machines. OpenWRT is used for dialing and routing, allocated two CPUs and 1GB of memory, with a passthrough network port for WAN connection to the optical modem. The Debian system is responsible for running most of the services I use daily, including providing DNS, RSS, and media services."><meta itemprop=datePublished content="2024-06-23T11:46:39+08:00"><meta itemprop=dateModified content="2024-06-23T11:46:39+08:00"><meta itemprop=wordCount content="789"><meta itemprop=keywords content="Nas,Docker"><meta name=twitter:card content="summary"><meta name=twitter:title content="Services Used in Nas"><meta name=twitter:description content="I installed the PVE system on the base layer of my NAS for virtualization, primarily using OpenWRT and Debian virtual machines. OpenWRT is used for dialing and routing, allocated two CPUs and 1GB of memory, with a passthrough network port for WAN connection to the optical modem. The Debian system is responsible for running most of the services I use daily, including providing DNS, RSS, and media services."><!--[if lte IE 9]>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script> <!
[endif]--><!--[if lt IE 9]>
	<script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script> <!
[endif]--></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=/en/ class=logo>Jiageng's Blog</a></div><div class=mobile-navbar-icon><span></span>
<span></span>
<span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=/en><li class=mobile-menu-item>Home</li></a><a href=/en/categories/><li class=mobile-menu-item>Categories</li></a><a href=/en/tags/><li class=mobile-menu-item>Tags</li></a><a href=/en/post/><li class=mobile-menu-item>Archives</li></a><a href=/en/about/><li class=mobile-menu-item>About</li></a></ul><div class=language-selector><ul class=languages-list><li class="language-item active"><a href=https://blog.diing.uk/en/post/services-used-in-nas/>English</a></li><li class=language-item><a href=https://blog.diing.uk/post/services-used-in-nas/>中文</a></li></ul></div></nav><div class=container id=mobile-panel><header id=header class=header><div class=logo-wrapper><a href=/en/ class=logo>Jiageng's Blog</a></div><div class=language-selector><ul class=languages-list><li class="language-item active"><a href=https://blog.diing.uk/en/post/services-used-in-nas/>English</a></li><li class=language-item><a href=https://blog.diing.uk/post/services-used-in-nas/>中文</a></li></ul></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=/en>Home</a></li><li class=menu-item><a class=menu-item-link href=/en/categories/>Categories</a></li><li class=menu-item><a class=menu-item-link href=/en/tags/>Tags</a></li><li class=menu-item><a class=menu-item-link href=/en/post/>Archives</a></li><li class=menu-item><a class=menu-item-link href=/en/about/>About</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><div id=content class=content><article class=post><header class=post-header><h1 class=post-title>Services Used in Nas</h1><div class=post-meta><span class=post-time>2024-06-23 </span><span class=more-meta>789 words </span><span class=more-meta>2 mins read </span><span id=busuanzi_container_page_pv class=more-meta><span id=busuanzi_value_page_pv><img src=/img/spinner.svg alt=spinner.svg></span> times read</span></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>Contents</h2><div class="post-toc-content always-active"><nav id=TableOfContents><ol><li><a href=#my-nas-overview>My NAS Overview</a></li><li><a href=#list-of-services-used>List of Services Used</a></li><li><a href=#providing-dns-service>Providing DNS Service</a><ol><li><a href=#adguard-home>Adguard Home</a></li><li><a href=#mosdns>MosDNS</a></li><li><a href=#others>Others</a></li></ol></li><li><a href=#reading-and-writing>Reading and Writing</a><ol><li><a href=#rss>RSS</a></li><li><a href=#writing>Writing</a></li></ol></li><li><a href=#file-management>File Management</a></li><li><a href=#other-services>Other Services</a></li><li><a href=#references-and-recommended-articles>References and Recommended Articles</a></li></ol></nav></div></div><div class=post-content><p>I installed the PVE system on the base layer of my NAS for virtualization, primarily using OpenWRT and Debian virtual machines.
OpenWRT is used for dialing and routing, allocated two CPUs and 1GB of memory, with a passthrough network port for WAN connection to the optical modem.
The Debian system is responsible for running most of the services I use daily, including providing DNS, RSS, and media services.</p><div><h2>Table Of Contents</h2><nav id=TableOfContents><ol><li><a href=#my-nas-overview>My NAS Overview</a></li><li><a href=#list-of-services-used>List of Services Used</a></li><li><a href=#providing-dns-service>Providing DNS Service</a><ol><li><a href=#adguard-home>Adguard Home</a></li><li><a href=#mosdns>MosDNS</a></li><li><a href=#others>Others</a></li></ol></li><li><a href=#reading-and-writing>Reading and Writing</a><ol><li><a href=#rss>RSS</a></li><li><a href=#writing>Writing</a></li></ol></li><li><a href=#file-management>File Management</a></li><li><a href=#other-services>Other Services</a></li><li><a href=#references-and-recommended-articles>References and Recommended Articles</a></li></ol></nav></div><h2 id=my-nas-overview>My NAS Overview</h2><ul><li>CPU: 4 x Intel(R) N100</li><li>RAM: 8 GB</li><li>Kernel: Linux 6.2.16-3-pve</li><li>Storage: One M.2 SSD + Two HDDs</li><li>Two Gigabit Ethernet ports</li></ul><h2 id=list-of-services-used>List of Services Used</h2><table><thead><tr><th>Category</th><th>Service Name</th><th>Function Description</th></tr></thead><tbody><tr><td>Network</td><td>OpenWrt</td><td>Router operating system</td></tr><tr><td></td><td>Proxmox VE</td><td>Virtualization platform</td></tr><tr><td></td><td>AdGuard Home</td><td>Network ad blocking and DNS management</td></tr><tr><td></td><td>MosDns</td><td>Provides DNS service as ADG upstream</td></tr><tr><td></td><td>DDNS-go</td><td>Dynamic DNS service</td></tr><tr><td></td><td>Neko</td><td>Remote desktop service</td></tr><tr><td>RSS & Writing</td><td>Miniflux</td><td>RSS reader</td></tr><tr><td></td><td>Wewe-rss</td><td>RSS subscription management</td></tr><tr><td></td><td>Memos</td><td>Note-taking tool</td></tr><tr><td></td><td>Dillinger</td><td>Markdown editor</td></tr><tr><td>File & Media</td><td>Aria2</td><td>Download tool</td></tr><tr><td></td><td>File Browser</td><td>File manager</td></tr><tr><td></td><td>Plex</td><td>Media server</td></tr><tr><td></td><td>Jellyfin</td><td>Open-source media system</td></tr><tr><td></td><td>Alist</td><td>File listing tool</td></tr><tr><td>Miscellaneous</td><td>Portainer</td><td>Docker container management</td></tr><tr><td></td><td>Watchtower</td><td>Automatic Docker container updates</td></tr><tr><td></td><td>Vault Warden</td><td>Password manager</td></tr><tr><td></td><td>Ntfy</td><td>Notification push service</td></tr></tbody></table><p>The table shows most of the applications I&rsquo;ve installed, all of which can be found on Github.
Homepage is the page I open most frequently, containing links to all the applications in the table, as shown below:
<img alt="Homepage display" src=https://r2gallery.diing.uk/%E5%9B%BE%E5%BA%8A%2Fhomepage.png></p><h2 id=providing-dns-service>Providing DNS Service</h2><p>To avoid DNS pollution and ISP monitoring, the most important service on my Debian VM is to obtain the fastest DNS and provide encrypted DNS service for all devices.
Simultaneously, this service also provides DNS caching and traffic splitting functions.</p><h3 id=adguard-home>Adguard Home</h3><p>My terminal devices <strong>first</strong> access Adguard Home (abbreviated as ADG) via DNS-over-TLS and DNS-over-HTTPS to obtain DNS.
In ADG, the upstream DNS is set to Mosdns and a remote DNS service (e.g., Mosdns on a VPS). Due to distance differences, ADG will first fetch local DNS, only using remote responses when local is abnormal.</p><h3 id=mosdns>MosDNS</h3><p>Mosdns implements the following functions:</p><ol><li>Cache DNS records and extend TTL</li><li>Filter ads through blacklists</li><li>Modify response IPs for services like Cloudflare to the best speed using speed testing tools</li><li>Synchronously query <strong>domestic websites</strong> through Alibaba and Tencent&rsquo;s encrypted DNS</li><li>Synchronously query <strong>non-domestic addresses</strong> through Cloudflare and DNS.SB encrypted DNS and set ECS</li><li>Verify IPs from step 5 to ensure no pollution</li></ol><h3 id=others>Others</h3><p>To assist the above functions, we need to run a DDNS service to update the NAS&rsquo;s public IP in real-time, and an acme.sh service to obtain TLS certificates.
Also, we need to map the port providing encrypted DNS service by ADG to the public network in OpenWRT.</p><h2 id=reading-and-writing>Reading and Writing</h2><h3 id=rss>RSS</h3><p>RSS is my daily channel for obtaining information. I use Read You and NetNewsWire for reading on mobile devices and record on Memos.</p><ul><li>To achieve synchronization across different devices, I set up Miniflux in Docker and integrated it into apps through Fever and Google Reader.</li><li>For WeChat public account articles, I use wewe-rss to fetch (need to set automatic full-text retrieval in miniflux).</li><li>For websites without RSS (e.g., Bilibili, X), I can obtain through RSShub.</li></ul><h3 id=writing>Writing</h3><ul><li>Memos provides a flomo-like experience but can be self-hosted. I use it to record fragments and manage with tags.</li><li>Dillinger is my favorite open-source Markdown writing tool after Typora became paid.</li></ul><h2 id=file-management>File Management</h2><p>File management in my NAS system mainly relies on the following services:</p><ul><li>Aria2: This is a powerful download tool supporting multiple protocols. I mainly use it for large file downloads and tasks that need to run for a long time. A visualization page for Aria2 is also running.</li><li>File Browser: This is a lightweight file manager providing an intuitive web interface.</li><li>Alist: While its functionality overlaps with File Browser, Alist&rsquo;s feature is its ability to integrate multiple storage sources. I use it to uniformly manage local storage and some cloud storage services, including Alibaba Cloud Drive, Cloudflare R2, and AWS S3.</li></ul><h2 id=other-services>Other Services</h2><ul><li>Portainer: The most famous Docker container web management interface.</li><li>Watchtower: This service automatically checks and updates Docker containers. It keeps my system always up-to-date and displays real-time update information on Homepage.</li><li>Vault Warden: This is a Rust implementation of Bitwarden, used as the server for my password manager. Self-hosting a password manager gives me more control over sensitive information while avoiding dependence on third-party services.</li><li>Ntfy: I use it to send various system notifications, including backup completion, storage space warnings, SSH login alerts, etc. It supports multiple receiving methods, including mobile apps and email, ensuring I receive important information promptly.</li></ul><h2 id=references-and-recommended-articles>References and Recommended Articles</h2><ul><li><a href=https://github.com/awesome-foss/awesome-sysadmin>awesome-sysadmin</a></li><li><a href=https://zituoguan.com/>Self-hosted Selection</a></li></ul></div><div class=post-copyright><p class=copyright-item><span class=item-title>Author</span>
<span class=item-content>Jiageng Ding</span></p><p class=copyright-item><span class=item-title>LastMod</span>
<span class=item-content>2024-06-23</span></p><p class=copyright-item><span class=item-title>License</span>
<span class=item-content><a rel=license href=http://creativecommons.org/licenses/by-nc-nd/4.0/>CC BY-NC-ND 4.0</a></span></p></div><footer class=post-footer><div class=post-tags><a href=/en/tags/nas/>nas</a>
<a href=/en/tags/docker/>docker</a></div><nav class=post-nav><a class=next href=/en/post/rip_aron/><span class="next-text nav-default">R.I.P. Aaron</span>
<span class="next-text nav-mobile">Next</span>
<i class="iconfont icon-right"></i></a></nav></footer></article></div><script src=https://utteranc.es/client.js repo=jiagengding/jiagengding.github.io issue-term=pathname theme=github-light crossorigin=anonymous async></script><noscript>Please enable JavaScript to view the <a href=https://github.com/utterance>comments powered by utterances.</a></noscript></div></main><footer id=footer class=footer><div class=social-links><a href=mailto:jiageng@mail.diing.uk class="iconfont icon-email" title=email></a><a href=https://www.linkedin.com/in/jiagengding/ class="iconfont icon-linkedin" title=linkedin></a><a href=https://github.com/jiagengding class="iconfont icon-github" title=github></a><a href=https://www.zhihu.com/people/dingjiageng class="iconfont icon-zhihu" title=zhihu></a><a href=https://www.instagram.com/ding.jg/ class="iconfont icon-instagram" title=instagram></a><a href=https://space.bilibili.com/37440196 class="iconfont icon-bilibili" title=bilibili></a><a href=https://blog.diing.uk/en/index.xml type=application/rss+xml class="iconfont icon-rss" title=rss></a></div><div class=copyright><div class=busuanzi-footer><span id=busuanzi_container_site_pv>site pv: <span id=busuanzi_value_site_pv><img src=/img/spinner.svg alt=spinner.svg></span> </span><span class=division>|</span> <span id=busuanzi_container_site_uv>site uv: <span id=busuanzi_value_site_uv><img src=/img/spinner.svg alt=spinner.svg></span></span></div><span class=copyright-year>&copy; 2021 - 2024<span class=heart><i class="iconfont icon-heart"></i></span>
<span>JiagengDing</span><br>All rights reserved, unless otherwise specified</span></div></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script src=https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/timeago.js@3.0.2/dist/timeago.min.js integrity="sha256-jwCP0NAdCBloaIWTWHmW4i3snUNMHUNO+jr9rYd2iOI=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/timeago.js@3.0.2/dist/timeago.locales.min.js integrity="sha256-ZwofwC1Lf/faQCzN7nZtfijVV6hSwxjQMwXL4gn9qU8=" crossorigin=anonymous></script><script>var languageCode="en".replace(/-/g,"_").replace(/_(.*)/,function(e,t){return e.replace(t,t.toUpperCase())});timeago().render(document.querySelectorAll(".timeago"),languageCode),timeago.cancel()</script><script type=text/javascript src=/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js></script><script type=text/javascript>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],tags:"ams"}}</script><script async src=https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin=anonymous></script></body></html>